# 第十章　隐马尔可夫模型

隐马尔可夫模型是用于**标注问题**的统计学习模型，描述由隐藏的马尔可夫链随机生成观测序列的过程，属于生成模型。隐马尔可夫模型在语音识别、自然语言处理、生物信息、模式识别等领域有着广泛的应用。

隐马尔可夫模型由初始状态概率分布$\pi$，状态转移概率矩阵$A$和观测概率矩阵$B$决定。$\pi$和$A$决定状态序列，$B$决定观测序列。因此隐马尔可夫模型$\lambda$可用三元符号来表示，即
$$
\lambda = (A, B, \pi),
$$
状态转移概率矩阵$A​$、观测概率矩阵$B​$和初始状态概率分布$\pi​$称为隐马尔可夫模型的三要素。隐马尔可夫模型作了两个基本假设：

- 齐次马尔可夫性假设，即假设隐藏的马尔可夫链在任意时刻$t$的状态只依赖于前一时刻$t-1$的状态，与其他时刻的状态或者观测无关；

- 观测独立性假设，即假设任意时刻$t$的观测只依赖于该时刻$t$的马尔可夫链的状态，与其他的状态以及观测无关。

隐马尔可夫模型有三个基本问题：

1. 估值问题。又称为概率计算问题，给定一个隐马尔可夫模型$\lambda = (A, B, \pi)$和某个观测特定序列$O=(o_1, o_2, \cdots, o_T)$，计算在该模型下观测序列$O$出现的概率$P(O|\lambda)$；
2. 预测问题。又称为解码问题，已知隐马尔可夫模型$\lambda = (A, B, \pi)$和某个观测特定序列$O=(o_1, o_2, \cdots, o_T)$，求最有可能产生该观测序列$O$的状态序列；
3. 学习问题。已知某一观测序列$O=(o_1, o_2, \cdots, o_T)$，估计隐马尔可夫模型$\lambda = (A, B, \pi)$的参数，使得在该模型中观测序列概率$P(O|\lambda)$最大。

## 10.1 概率计算方法

（**前向概率**）给定隐马尔可夫模型$\lambda$，定义到时刻$t$的部分可观测序列为$o_1, \cdots, o_t$且在该时刻状态$i_t$为$q_i$的概率为前向概率，记作
$$
\alpha_{t}(i)=P(o_1,\cdots,o_t,i_{t}=q_i|\lambda)
$$
观测序列概率的前向算法：

- 输入：隐马尔可夫模型$\lambda$，以及观测序列$O$;

1. 计算初值
   $$
   \alpha_1(i)=\pi_{i}b_{i}(o_1),\quad i=1,2,\cdots,N
   $$

2. 递推计算，对$t=1,2,\cdots, T-1$有
   $$
   \alpha_{t+1}(i)=[\sum_{j=1}^{N}\alpha_{t}(j)a_{ji}]b_{i}(o_{t+1}),\quad i=1,2,\cdots,N
   $$

3. 终止
   $$
   P(O|\lambda)=\sum_{i=1}^{N}\alpha_{T}(i)
   $$

- 输出：观测序列概率$P(O|\lambda)$；

（**后向概率**）给定隐马尔可夫模型$\lambda$，在时刻$t$的状态为$q_i$的条件下，定义从$t+1$到$T$的部分观测序列为$o_{t+1},o_{t+2},\cdots,o_T$的概率为后向概率，记作
$$
\beta_{t}(i)=P(o_{t+1},o_{t+2},\cdots,o_T|i_t=q_i,\lambda )
$$
观测序列概率的后向算法：

- 输入：隐马尔可夫模型$\lambda$，以及观测序列$O$;

1. 规定
   $$
   \beta_{T}(i)=1,\quad i=1,2,\cdots,N
   $$

2. 递推计算，对$t=T-1,T-2,\cdots,1$有
   $$
   \beta_{t}(i)=\sum_{j=1}^{N}a_{ij}b_j(o_{t+1})\beta_{t+1}(j),\quad i=1,2,\cdots,N
   $$

3. 终止
   $$
   P(O|\lambda)=\sum_{i=1}^{N}\pi_{i}b_{i}(o_1)\beta_1(i)
   $$

- 输出：观测序列概率$P(O|\lambda)$；

利用前向概率和后向概率的定义，可以将观测序列概率$P(O|\lambda)​$重新写成：
$$
P(O|\lambda)＝\sum_{i=1}^{N}\sum_{j=1}^{N}\alpha_t(i)a_{ij}b_j(o_{t+1})\beta_{t+1}(j)
$$

## 10.2 学习算法

